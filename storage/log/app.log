[2025-05-05 16:09:43,385.385] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 16:09:43,386.386] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 16:09:43,386.386] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:09:46,295.295] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:09:46,333.333] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:09:48,813.813] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:09:48,813.813] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:09:48,814.814] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:09:48,814.814] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:09:48,815.815] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:09:48,815.815] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:09:48,816.816] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:09:48,817.817] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:09:48,818.818] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00037s] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:09:48,826.826] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:09:48,826.826] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:09:48,828.828] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:09:48,829.829] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:09:48,830.830] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:09:48,830.830] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:09:48,832.832] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:09:48,833.833] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00029s] {'pk_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 16:09:48,853.853] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 16:09:48,853.853] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:09:48,859.859] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 16:09:48,859.859] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'id_1_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:09:48,861.861] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 16:09:48,861.861] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00067s] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["e6f76913-2394-4c98-8fc3-e43e99d938c4", "c1699770-c08 ... (196726 characters truncated) ... e4e5", "4f3193b1-5c62-4e77-8b51-f548e4810d9d"], "AsyncSqliteSaver": ["5864a71f-f3ea-4022-86c3-e9a13d573185", "36f39a56-05bf-4d26-a2a7-b7c48973e703"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 16:09:48,876.876] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:09:48,878.878] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:09:48,878.878] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:09:48,878.878] base.py -> _execute_context line:1843 [INFO]: [cached since 0.04825s ago] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:09:48,879.879] segment_service.py -> update_segment_enabled line:130 [ERROR]: æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€æˆåŠŸ, segment_id: c6e99a9c-aeaf-489f-bb3d-9113ceb882f7, enabled: eb08fe2f-535c-494a-bdb0-14e90c6fdd3f
NoneType: None
[2025-05-05 16:09:48,881.881] segment_service.py -> update_segment_enabled line:138 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: c6e99a9c-aeaf-489f-bb3d-9113ceb882f7, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 134, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 16:09:48,884.884] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 134, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 56, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 149, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 16:09:48,886.886] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:09:48,886.886] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:09:48] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/b98ed149-b7a8-4356-a218-ae5692cec3bc/segments/c6e99a9c-aeaf-489f-bb3d-9113ceb882f7/enabled HTTP/1.1" 200 -
[2025-05-05 16:12:28,548.548] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:12:29,390.390] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:12:33,272.272] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:12:33,285.285] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:12:34,435.435] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:12:35,023.023] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:12:38,420.420] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:12:38,431.431] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:12:42,713.713] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:12:43,094.094] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:12:46,619.619] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:12:46,631.631] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:12:51,644.644] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:12:51,645.645] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:12:51,646.646] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:12:51,646.646] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:12:51,646.646] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:12:51,646.646] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:12:51,647.647] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:12:51,649.649] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:12:51,650.650] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00039s] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:12:51,662.662] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:12:51,662.662] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00026s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 16, 12, 51, 659790), 'segment_id': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:12:51,663.663] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:12:51,664.664] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:12:51,665.665] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:12:51,665.665] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:12:51,668.668] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:12:51,668.668] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00029s] {'pk_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 16:12:51,671.671] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 16:12:51,671.671] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:12:51,679.679] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 16:12:51,679.679] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00082s] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["e6f76913-2394-4c98-8fc3-e43e99d938c4", "c1699770-c08 ... (196326 characters truncated) ... e4e5", "4f3193b1-5c62-4e77-8b51-f548e4810d9d"], "AsyncSqliteSaver": ["5864a71f-f3ea-4022-86c3-e9a13d573185", "36f39a56-05bf-4d26-a2a7-b7c48973e703"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 16:12:51,696.696] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:12:51,699.699] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:12:51,700.700] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:12:51,700.700] base.py -> _execute_context line:1843 [INFO]: [cached since 0.0349s ago] {'pk_1': UUID('c6e99a9c-aeaf-489f-bb3d-9113ceb882f7')}
[2025-05-05 16:12:51,708.708] segment_service.py -> update_segment_enabled line:134 [ERROR]: æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€æˆåŠŸ, one: False, enabled: eb08fe2f-535c-494a-bdb0-14e90c6fdd3f
NoneType: None
[2025-05-05 16:12:51,711.711] segment_service.py -> update_segment_enabled line:143 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: c6e99a9c-aeaf-489f-bb3d-9113ceb882f7, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 139, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 16:12:51,715.715] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 139, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 56, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 154, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 16:12:51,719.719] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:12:51,720.720] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:12:51] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/b98ed149-b7a8-4356-a218-ae5692cec3bc/segments/c6e99a9c-aeaf-489f-bb3d-9113ceb882f7/enabled HTTP/1.1" 200 -
[2025-05-05 16:16:30,255.255] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/indexing_service.py', reloading
[2025-05-05 16:16:30,691.691] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:16:34,282.282] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:16:34,311.311] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:18:05,554.554] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/indexing_service.py', reloading
[2025-05-05 16:18:05,954.954] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:18:09,457.457] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:18:09,470.470] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:18:54,562.562] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/indexing_service.py', reloading
[2025-05-05 16:18:55,014.014] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:18:58,773.773] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:18:58,783.783] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:19:37,303.303] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/indexing_service.py', reloading
[2025-05-05 16:19:37,711.711] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:19:41,392.392] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:19:41,403.403] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:20:08,662.662] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:20:09,215.215] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:20:57,711.711] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 16:20:57,712.712] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 16:20:57,713.713] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:21:01,084.084] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:21:01,117.117] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:21:08,504.504] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:21:08,939.939] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:21:12,257.257] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:21:12,275.275] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:21:45,724.724] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:21:46,136.136] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:21:49,935.935] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:21:49,946.946] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:22:02,491.491] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:22:02,978.978] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:22:06,383.383] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:22:06,397.397] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:22:31,623.623] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/model/dataset.py', reloading
[2025-05-05 16:22:32,331.331] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:22:35,723.723] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:22:35,735.735] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:22:36,850.850] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/model/dataset.py', reloading
[2025-05-05 16:22:40,704.704] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 16:22:40,704.704] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 16:22:40,705.705] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:22:43,802.802] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:22:43,843.843] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:22:55,571.571] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:22:55,572.572] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:22:55,573.573] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:22:55,573.573] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:22:55,573.573] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:22:55,573.573] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:22:55,574.574] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:22:55,576.576] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:22:55,576.576] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:22:55,579.579] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-05 16:22:55,579.579] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': '94acfe76-bbad-4d4c-9751-bfcd36bca124'}
[2025-05-05 16:22:55,582.582] base.py -> _execute_context line:1843 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-05 16:22:55,582.582] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00021s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\\n"], "chunk_size": 200, "chunk_overlap": 20}}'}
[2025-05-05 16:22:55,586.586] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:22:55,587.587] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:22:55,588.588] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-05 16:22:55,589.589] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00028s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 1}
[2025-05-05 16:22:55,591.591] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 16:22:55,591.591] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'pk_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:22:55,593.593] base.py -> _execute_context line:1843 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-05 16:22:55,593.593] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00009s] {'pk_1': UUID('8599c786-3528-4376-b40a-6106c23dfe27')}
[2025-05-05 16:22:55,595.595] base.py -> _execute_context line:1843 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-05 16:22:55,595.595] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'upload_file_id': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124'), 'process_rule_id': UUID('8599c786-3528-4376-b40a-6106c23dfe27'), 'batch': '20250505162255542472', 'name': 'langGraph.md', 'position': 26, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-05 16:22:55,597.597] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:22:55,602.602] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:22:55,603.603] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:22:55,603.603] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00028s] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:22:55,650.650] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:22:55,651.651] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:22:55] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 16:23:04,972.972] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:04,974.974] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:23:04,975.975] base.py -> _execute_context line:1843 [INFO]: [cached since 9.399s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:23:04,978.978] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 16:23:04,979.979] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00045s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505162255542472'}
[2025-05-05 16:23:04,982.982] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:23:04,982.982] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:04,986.986] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 16:23:04,987.987] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 16:23:04,988.988] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 16:23:04,988.988] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:23:04,990.990] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:04,991.991] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:04] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505162255542472 HTTP/1.1" 200 -
[2025-05-05 16:23:08,567.567] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:08,567.567] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:23:08,567.567] base.py -> _execute_context line:1843 [INFO]: [cached since 12.99s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:23:08,568.568] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 16:23:08,569.569] base.py -> _execute_context line:1843 [INFO]: [cached since 3.59s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505162255542472'}
[2025-05-05 16:23:08,569.569] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:23:08,569.569] base.py -> _execute_context line:1843 [INFO]: [cached since 3.588s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:08,570.570] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 16:23:08,570.570] base.py -> _execute_context line:1843 [INFO]: [cached since 3.584s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 16:23:08,571.571] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 16:23:08,571.571] base.py -> _execute_context line:1843 [INFO]: [cached since 3.583s ago] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:23:08,572.572] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:08,572.572] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:08] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505162255542472 HTTP/1.1" 200 -
[2025-05-05 16:23:09,415.415] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:09,415.415] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:23:09,416.416] base.py -> _execute_context line:1843 [INFO]: [cached since 13.84s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:23:09,420.420] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 16:23:09,421.421] base.py -> _execute_context line:1843 [INFO]: [cached since 4.443s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505162255542472'}
[2025-05-05 16:23:09,422.422] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:23:09,422.422] base.py -> _execute_context line:1843 [INFO]: [cached since 4.441s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:09,423.423] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 16:23:09,423.423] base.py -> _execute_context line:1843 [INFO]: [cached since 4.437s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 16:23:09,424.424] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 16:23:09,424.424] base.py -> _execute_context line:1843 [INFO]: [cached since 4.436s ago] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:23:09,425.425] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:09,428.428] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:09] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505162255542472 HTTP/1.1" 200 -
[2025-05-05 16:23:10,073.073] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:10,073.073] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:23:10,073.073] base.py -> _execute_context line:1843 [INFO]: [cached since 14.5s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:23:10,074.074] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 16:23:10,074.074] base.py -> _execute_context line:1843 [INFO]: [cached since 5.096s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505162255542472'}
[2025-05-05 16:23:10,075.075] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:23:10,075.075] base.py -> _execute_context line:1843 [INFO]: [cached since 5.093s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:10,077.077] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 16:23:10,078.078] base.py -> _execute_context line:1843 [INFO]: [cached since 5.091s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 16:23:10,079.079] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 16:23:10,079.079] base.py -> _execute_context line:1843 [INFO]: [cached since 5.091s ago] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:23:10,080.080] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:10,080.080] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:10] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505162255542472 HTTP/1.1" 200 -
[2025-05-05 16:23:28,665.665] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:28,669.669] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:23:28,669.669] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00090s] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:28,675.675] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 29, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 256, in get_segments_with_page
    raise NotFoundException("è¯¥çŸ¥è¯†åº“æ–‡æ¡£ä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 16:23:28,682.682] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:28,685.685] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:28] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:23:31,986.986] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:31,986.986] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:23:31,987.987] base.py -> _execute_context line:1843 [INFO]: [cached since 3.318s ago] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:31,988.988] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 29, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 256, in get_segments_with_page
    raise NotFoundException("è¯¥çŸ¥è¯†åº“æ–‡æ¡£ä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 16:23:31,990.990] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:31,990.990] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:31] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:23:42,901.901] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:42,903.903] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:23:42,903.903] base.py -> _execute_context line:1843 [INFO]: [cached since 47.33s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:23:42,906.906] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 16:23:42,906.906] base.py -> _execute_context line:1843 [INFO]: [cached since 37.93s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505162255542472'}
[2025-05-05 16:23:42,907.907] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:23:42,907.907] base.py -> _execute_context line:1843 [INFO]: [cached since 37.93s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:42,909.909] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 16:23:42,909.909] base.py -> _execute_context line:1843 [INFO]: [cached since 37.92s ago] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 16:23:42,910.910] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 16:23:42,910.910] base.py -> _execute_context line:1843 [INFO]: [cached since 37.92s ago] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 16:23:42,910.910] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:42,911.911] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:42] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505162255542472 HTTP/1.1" 200 -
[2025-05-05 16:23:57,346.346] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:57,346.346] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:23:57,347.347] base.py -> _execute_context line:1843 [INFO]: [cached since 28.68s ago] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:57,349.349] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 29, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 256, in get_segments_with_page
    raise NotFoundException("è¯¥çŸ¥è¯†åº“æ–‡æ¡£ä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 16:23:57,349.349] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:57,350.350] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:57] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:23:57,996.996] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:23:57,996.996] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:23:57,996.996] base.py -> _execute_context line:1843 [INFO]: [cached since 29.33s ago] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:23:57,997.997] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 29, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 256, in get_segments_with_page
    raise NotFoundException("è¯¥çŸ¥è¯†åº“æ–‡æ¡£ä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 16:23:57,998.998] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:23:57,998.998] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:23:57] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:24:00,515.515] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:24:00,516.516] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:24:00,516.516] base.py -> _execute_context line:1843 [INFO]: [cached since 31.85s ago] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:24:00,518.518] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 29, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 256, in get_segments_with_page
    raise NotFoundException("è¯¥çŸ¥è¯†åº“æ–‡æ¡£ä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 16:24:00,519.519] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:24:00,519.519] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:24:00] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:24:39,097.097] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:24:39,549.549] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:24:43,365.365] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:24:43,376.376] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:24:43,470.470] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:24:43,470.470] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:24:43,471.471] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:24:43,471.471] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:24:43,471.471] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:24:43,471.471] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:24:43,472.472] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:24:43,474.474] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:24:43,474.474] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00029s] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:24:43,478.478] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:24:43,478.478] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:24:43,483.483] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 16:24:43,484.484] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:24:43,486.486] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:24:43,486.486] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:24:43] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments HTTP/1.1" 200 -
[2025-05-05 16:24:59,529.529] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:24:59,531.531] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:24:59,531.531] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00028s] {'pk_1': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:24:59,542.542] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:24:59,542.542] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00021s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 16, 24, 59, 540772), 'segment_id': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:24:59,544.544] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:24:59,545.545] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:24:59,546.546] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:24:59,546.546] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'pk_1': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:24:59,548.548] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:24:59,548.548] base.py -> _execute_context line:1843 [INFO]: [cached since 16.07s ago] {'pk_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:24:59,551.551] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 16:24:59,552.552] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:24:59,559.559] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 16:24:59,559.559] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00083s] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["e6f76913-239 ... (217926 characters truncated) ... e4e5"], "AsyncSqliteSaver": ["a1a5702d-1b47-401c-a40d-525904ad995f", "5864a71f-f3ea-4022-86c3-e9a13d573185", "36f39a56-05bf-4d26-a2a7-b7c48973e703"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 16:24:59,581.581] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:24:59,585.585] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:24:59,585.585] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:24:59,585.585] base.py -> _execute_context line:1843 [INFO]: [cached since 0.03926s ago] {'pk_1': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:24:59,594.594] segment_service.py -> update_segment_enabled line:341 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: ea2f6722-24d9-460c-91d4-c6a155072ac5, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 16:24:59,597.597] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET disabled_at=%(disabled_at)s, stopped_at=%(stopped_at)s, error=%(error)s, status=%(status)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:24:59,597.597] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00011s] {'disabled_at': datetime.datetime(2025, 5, 5, 16, 24, 59, 597206), 'stopped_at': datetime.datetime(2025, 5, 5, 16, 24, 59, 597208), 'error': 'Object was not updated.! Unexpected status code: 404, with response body: None.', 'status': <SegmentStatus.ERROR: 'error'>, 'segment_id': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:24:59,601.601] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:24:59,606.606] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 56, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 352, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 16:24:59,611.611] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:24:59] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments/ea2f6722-24d9-460c-91d4-c6a155072ac5/enabled HTTP/1.1" 200 -
[2025-05-05 16:25:06,440.440] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:25:06,441.441] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:25:06,441.441] base.py -> _execute_context line:1843 [INFO]: [cached since 6.91s ago] {'pk_1': UUID('ea2f6722-24d9-460c-91d4-c6a155072ac5')}
[2025-05-05 16:25:06,456.456] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:25:06,456.456] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:25:06] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/acf1533e-8098-4c11-aac8-7bfb430ac40d/segments/ea2f6722-24d9-460c-91d4-c6a155072ac5 HTTP/1.1" 200 -
[2025-05-05 16:29:06,141.141] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:06,144.144] base.py -> _execute_context line:1843 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-05-05 16:29:06,144.144] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00032s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'name': 'langGraph.md', 'key': '2025/05/05/120f888d-3891-44a1-84ce-9ef543bc3894.md', 'size': 30727, 'extension': 'md', 'mime_type': 'text/markdown', 'hash': 'a955165394ae8e007eb4da6b89c204c5f5d3abb47094e6f93b7b60cf96c9d361'}
[2025-05-05 16:29:06,161.161] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:29:06,165.165] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:06,166.166] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 16:29:06,167.167] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00047s] {'pk_1': UUID('e1d89c62-8c66-4cb4-a704-1b3710f00b51')}
[2025-05-05 16:29:06,170.170] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:29:06,171.171] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:29:06] "POST /upload-files/file HTTP/1.1" 200 -
[2025-05-05 16:29:22,125.125] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:22,128.128] base.py -> _execute_context line:1843 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-05-05 16:29:22,128.128] base.py -> _execute_context line:1843 [INFO]: [cached since 15.98s ago] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'name': 'requirements.txt', 'key': '2025/05/05/f6e5331d-6d87-422a-aab0-906cef702422.txt', 'size': 346, 'extension': 'txt', 'mime_type': 'text/plain', 'hash': '8204ebe55b517c8a50af0734d943a72055c02bde2c1bce9eca02eafd2e27c6ea'}
[2025-05-05 16:29:22,132.132] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:29:22,135.135] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:22,135.135] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 16:29:22,135.135] base.py -> _execute_context line:1843 [INFO]: [cached since 15.97s ago] {'pk_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 16:29:22,137.137] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:29:22,138.138] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:29:22] "POST /upload-files/file HTTP/1.1" 200 -
[2025-05-05 16:29:41,787.787] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:41,789.789] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:29:41,789.789] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00026s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:29:41,799.799] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-05 16:29:41,799.799] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00025s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': '3d8bd984-2744-4aee-8390-246e3da02efe'}
[2025-05-05 16:29:41,801.801] base.py -> _execute_context line:1843 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-05 16:29:41,801.801] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\\n"], "chunk_size": 200, "chunk_overlap": 20}}'}
[2025-05-05 16:29:41,802.802] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:29:41,804.804] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:41,805.805] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-05 16:29:41,805.805] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00038s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 1}
[2025-05-05 16:29:41,806.806] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 16:29:41,806.806] base.py -> _execute_context line:1843 [INFO]: [cached since 35.64s ago] {'pk_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 16:29:41,807.807] base.py -> _execute_context line:1843 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-05 16:29:41,807.807] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'pk_1': UUID('84ef4ac1-c070-43b6-b872-358fa8ac5c9c')}
[2025-05-05 16:29:41,809.809] base.py -> _execute_context line:1843 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-05 16:29:41,809.809] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00014s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'upload_file_id': UUID('3d8bd984-2744-4aee-8390-246e3da02efe'), 'process_rule_id': UUID('84ef4ac1-c070-43b6-b872-358fa8ac5c9c'), 'batch': '20250505162941788238', 'name': 'requirements.txt', 'position': 27, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-05 16:29:41,810.810] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:29:41,817.817] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:29:41,818.818] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:29:41,818.818] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:29:41,978.978] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:29:41,978.978] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:29:41] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 16:30:03,660.660] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:30:03,661.661] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:30:03,661.661] base.py -> _execute_context line:1843 [INFO]: [cached since 320.2s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:30:03,675.675] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:30:03,675.675] base.py -> _execute_context line:1843 [INFO]: [cached since 320.2s ago] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:30:03,677.677] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 16:30:03,678.678] base.py -> _execute_context line:1843 [INFO]: [cached since 320.2s ago] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:30:03,679.679] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:30:03,680.680] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:30:03] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 16:30:17,131.131] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:30:17,132.132] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:30:17,133.133] base.py -> _execute_context line:1843 [INFO]: [cached since 317.6s ago] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:30:17,134.134] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:30:17,135.135] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:30:17] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336 HTTP/1.1" 200 -
[2025-05-05 16:30:38,295.295] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:30:38,757.757] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:30:42,322.322] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:30:42,334.334] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:30:42,412.412] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:30:42,412.412] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:30:42,413.413] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:30:42,413.413] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:30:42,414.414] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:30:42,414.414] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:30:42,414.414] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:30:42,416.416] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:30:42,416.416] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00015s] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:30:42,429.429] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:30:42,429.429] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 16, 30, 42, 427860), 'segment_id': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:30:42,430.430] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:30:42,431.431] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:30:42,432.432] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:30:42,432.432] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00015s] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:30:42,434.434] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:30:42,434.434] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00038s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:30:42,438.438] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 16:30:42,438.438] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00012s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:30:42,444.444] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 16:30:42,445.445] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00075s] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["e6f76913-239 ... (217926 characters truncated) ... e4e5"], "AsyncSqliteSaver": ["a1a5702d-1b47-401c-a40d-525904ad995f", "5864a71f-f3ea-4022-86c3-e9a13d573185", "36f39a56-05bf-4d26-a2a7-b7c48973e703"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 16:30:42,468.468] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:30:42,471.471] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:30:42,471.471] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:30:42,471.471] base.py -> _execute_context line:1843 [INFO]: [cached since 0.03962s ago] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:30:42,475.475] segment_service.py -> update_segment_enabled line:341 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: 0aa3644d-4d94-48e6-acbc-205d5aaad336, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 16:30:42,478.478] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 56, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 352, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 16:30:42,481.481] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:30:42,481.481] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:30:42] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336/enabled HTTP/1.1" 200 -
[2025-05-05 16:34:43,986.986] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:34:44,392.392] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:34:47,825.825] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:34:47,838.838] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:37:45,556.556] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:37:45,556.556] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:37:45,557.557] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:37:45,557.557] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:37:45,580.580] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:37:45,580.580] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:37:45,580.580] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:37:45,583.583] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:37:45,583.583] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'pk_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:45,585.585] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/document_handler.py", line 75, in update_document_enabled
    self.document_service.update_document_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/document_service.py", line 224, in update_document_enabled
    raise FailException(
internal.exception.exception.FailException
[2025-05-05 16:37:45,589.589] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:37:45,589.589] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:37:45] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/e2757cbf-60c3-43be-be03-d3b20a5eb365/enabled HTTP/1.1" 200 -
[2025-05-05 16:37:51,252.252] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:37:51,253.253] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:37:51,254.254] base.py -> _execute_context line:1843 [INFO]: [cached since 5.672s ago] {'pk_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:51,272.272] base.py -> _execute_context line:1843 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2025-05-05 16:37:51,272.272] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00025s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 16, 37, 51, 271410), 'document_id': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:51,273.273] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:37:51,284.284] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:37:51,286.286] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:37:51,286.286] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'pk_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:51,360.360] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:37:51,360.360] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:37:51] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/e2757cbf-60c3-43be-be03-d3b20a5eb365/enabled HTTP/1.1" 200 -
[2025-05-05 16:37:56,092.092] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:37:56,092.092] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:37:56,092.092] base.py -> _execute_context line:1843 [INFO]: [cached since 10.51s ago] {'pk_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:56,094.094] base.py -> _execute_context line:1843 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2025-05-05 16:37:56,095.095] base.py -> _execute_context line:1843 [INFO]: [cached since 4.823s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:56,095.095] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:37:56,096.096] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:37:56,096.096] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:37:56,096.096] base.py -> _execute_context line:1843 [INFO]: [cached since 4.811s ago] {'pk_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:37:56,113.113] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:37:56,113.113] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:37:56] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/e2757cbf-60c3-43be-be03-d3b20a5eb365/enabled HTTP/1.1" 200 -
[2025-05-05 16:39:19,755.755] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:39:19,756.756] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:39:19,757.757] base.py -> _execute_context line:1843 [INFO]: [cached since 94.18s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:39:19,762.762] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:39:19,763.763] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00066s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:39:19,772.772] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 16:39:19,773.773] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:39:19,783.783] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:39:19,784.784] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:39:19] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 16:39:29,493.493] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:39:29,495.495] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:39:29,495.495] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00010s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:39:29,498.498] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:39:29,498.498] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00037s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:39:29,500.500] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-05 16:39:29,501.501] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:39:29,502.502] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,502.502] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00014s] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:39:29,507.507] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,507.507] base.py -> _execute_context line:1843 [INFO]: [cached since 0.004452s ago] {'coalesce_2': 0, 'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:39:29,508.508] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,508.508] base.py -> _execute_context line:1843 [INFO]: [cached since 0.005411s ago] {'coalesce_2': 0, 'document_id_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 16:39:29,509.509] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,509.509] base.py -> _execute_context line:1843 [INFO]: [cached since 0.006385s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ec61ff1-9735-4b1d-a11f-0d3d547a8e5c')}
[2025-05-05 16:39:29,509.509] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,510.510] base.py -> _execute_context line:1843 [INFO]: [cached since 0.007278s ago] {'coalesce_2': 0, 'document_id_1': UUID('6d8dc5ba-6c50-4304-84ab-c7fe4cd42b5e')}
[2025-05-05 16:39:29,511.511] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,511.511] base.py -> _execute_context line:1843 [INFO]: [cached since 0.00882s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1766885-96ae-491c-8d73-4a77219f4086')}
[2025-05-05 16:39:29,515.515] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,515.515] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01303s ago] {'coalesce_2': 0, 'document_id_1': UUID('3a8c6ef2-ac17-457e-b471-1da0943376ab')}
[2025-05-05 16:39:29,518.518] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,518.518] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01581s ago] {'coalesce_2': 0, 'document_id_1': UUID('5518081a-6aa3-4e8b-9276-204a3c03da0f')}
[2025-05-05 16:39:29,520.520] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,520.520] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01758s ago] {'coalesce_2': 0, 'document_id_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:39:29,521.521] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,521.521] base.py -> _execute_context line:1843 [INFO]: [cached since 0.0184s ago] {'coalesce_2': 0, 'document_id_1': UUID('5281e628-c5be-4ed3-ae61-e62479b8423c')}
[2025-05-05 16:39:29,522.522] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,522.522] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02018s ago] {'coalesce_2': 0, 'document_id_1': UUID('7ee31973-ec39-44df-ba84-a7073a67c5db')}
[2025-05-05 16:39:29,524.524] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,524.524] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02136s ago] {'coalesce_2': 0, 'document_id_1': UUID('dd4195bc-0960-464c-b415-b4e24fc99fd5')}
[2025-05-05 16:39:29,525.525] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,525.525] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02243s ago] {'coalesce_2': 0, 'document_id_1': UUID('58eba5c9-505e-4b79-a7d5-9f7dd08045f5')}
[2025-05-05 16:39:29,527.527] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,527.527] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02466s ago] {'coalesce_2': 0, 'document_id_1': UUID('e5bd39e5-c889-43b1-bf5d-bfa85110f0b3')}
[2025-05-05 16:39:29,528.528] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,528.528] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02541s ago] {'coalesce_2': 0, 'document_id_1': UUID('eee8706b-e573-4a5f-b58c-9fc28d0587a7')}
[2025-05-05 16:39:29,529.529] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,530.530] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02743s ago] {'coalesce_2': 0, 'document_id_1': UUID('632163f8-e6da-4379-8c13-84a0ee020e56')}
[2025-05-05 16:39:29,531.531] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,531.531] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02924s ago] {'coalesce_2': 0, 'document_id_1': UUID('b63c3fed-6bd6-45a5-bbaa-b16ca297a514')}
[2025-05-05 16:39:29,532.532] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,532.532] base.py -> _execute_context line:1843 [INFO]: [cached since 0.02993s ago] {'coalesce_2': 0, 'document_id_1': UUID('11e38a1e-1a9b-4821-828a-ed5009175593')}
[2025-05-05 16:39:29,533.533] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,533.533] base.py -> _execute_context line:1843 [INFO]: [cached since 0.03047s ago] {'coalesce_2': 0, 'document_id_1': UUID('1f12a588-af25-4c99-a792-89a139d5b381')}
[2025-05-05 16:39:29,533.533] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:29,534.534] base.py -> _execute_context line:1843 [INFO]: [cached since 0.03125s ago] {'coalesce_2': 0, 'document_id_1': UUID('4b666f5e-c37e-490f-8e9f-48fdc1a15009')}
[2025-05-05 16:39:29,535.535] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:39:29,535.535] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:39:29] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 16:39:34,013.013] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:39:34,013.013] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 16:39:34,013.013] base.py -> _execute_context line:1843 [INFO]: [cached since 4.519s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:39:34,014.014] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:39:34,015.015] base.py -> _execute_context line:1843 [INFO]: [cached since 4.517s ago] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:39:34,016.016] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-05 16:39:34,016.016] base.py -> _execute_context line:1843 [INFO]: [cached since 4.515s ago] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:39:34,017.017] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,017.017] base.py -> _execute_context line:1843 [INFO]: [cached since 4.515s ago] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:39:34,018.018] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,018.018] base.py -> _execute_context line:1843 [INFO]: [cached since 4.516s ago] {'coalesce_2': 0, 'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 16:39:34,018.018] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,019.019] base.py -> _execute_context line:1843 [INFO]: [cached since 4.516s ago] {'coalesce_2': 0, 'document_id_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 16:39:34,020.020] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,020.020] base.py -> _execute_context line:1843 [INFO]: [cached since 4.518s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ec61ff1-9735-4b1d-a11f-0d3d547a8e5c')}
[2025-05-05 16:39:34,021.021] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,021.021] base.py -> _execute_context line:1843 [INFO]: [cached since 4.519s ago] {'coalesce_2': 0, 'document_id_1': UUID('6d8dc5ba-6c50-4304-84ab-c7fe4cd42b5e')}
[2025-05-05 16:39:34,022.022] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,022.022] base.py -> _execute_context line:1843 [INFO]: [cached since 4.52s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1766885-96ae-491c-8d73-4a77219f4086')}
[2025-05-05 16:39:34,023.023] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,023.023] base.py -> _execute_context line:1843 [INFO]: [cached since 4.521s ago] {'coalesce_2': 0, 'document_id_1': UUID('3a8c6ef2-ac17-457e-b471-1da0943376ab')}
[2025-05-05 16:39:34,024.024] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,024.024] base.py -> _execute_context line:1843 [INFO]: [cached since 4.522s ago] {'coalesce_2': 0, 'document_id_1': UUID('5518081a-6aa3-4e8b-9276-204a3c03da0f')}
[2025-05-05 16:39:34,027.027] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,027.027] base.py -> _execute_context line:1843 [INFO]: [cached since 4.525s ago] {'coalesce_2': 0, 'document_id_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 16:39:34,028.028] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,028.028] base.py -> _execute_context line:1843 [INFO]: [cached since 4.526s ago] {'coalesce_2': 0, 'document_id_1': UUID('5281e628-c5be-4ed3-ae61-e62479b8423c')}
[2025-05-05 16:39:34,029.029] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,029.029] base.py -> _execute_context line:1843 [INFO]: [cached since 4.527s ago] {'coalesce_2': 0, 'document_id_1': UUID('7ee31973-ec39-44df-ba84-a7073a67c5db')}
[2025-05-05 16:39:34,030.030] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,030.030] base.py -> _execute_context line:1843 [INFO]: [cached since 4.528s ago] {'coalesce_2': 0, 'document_id_1': UUID('dd4195bc-0960-464c-b415-b4e24fc99fd5')}
[2025-05-05 16:39:34,031.031] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,031.031] base.py -> _execute_context line:1843 [INFO]: [cached since 4.529s ago] {'coalesce_2': 0, 'document_id_1': UUID('58eba5c9-505e-4b79-a7d5-9f7dd08045f5')}
[2025-05-05 16:39:34,031.031] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,032.032] base.py -> _execute_context line:1843 [INFO]: [cached since 4.529s ago] {'coalesce_2': 0, 'document_id_1': UUID('e5bd39e5-c889-43b1-bf5d-bfa85110f0b3')}
[2025-05-05 16:39:34,032.032] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,032.032] base.py -> _execute_context line:1843 [INFO]: [cached since 4.53s ago] {'coalesce_2': 0, 'document_id_1': UUID('eee8706b-e573-4a5f-b58c-9fc28d0587a7')}
[2025-05-05 16:39:34,033.033] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,033.033] base.py -> _execute_context line:1843 [INFO]: [cached since 4.531s ago] {'coalesce_2': 0, 'document_id_1': UUID('632163f8-e6da-4379-8c13-84a0ee020e56')}
[2025-05-05 16:39:34,034.034] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,034.034] base.py -> _execute_context line:1843 [INFO]: [cached since 4.531s ago] {'coalesce_2': 0, 'document_id_1': UUID('b63c3fed-6bd6-45a5-bbaa-b16ca297a514')}
[2025-05-05 16:39:34,034.034] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,034.034] base.py -> _execute_context line:1843 [INFO]: [cached since 4.532s ago] {'coalesce_2': 0, 'document_id_1': UUID('11e38a1e-1a9b-4821-828a-ed5009175593')}
[2025-05-05 16:39:34,035.035] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,035.035] base.py -> _execute_context line:1843 [INFO]: [cached since 4.533s ago] {'coalesce_2': 0, 'document_id_1': UUID('1f12a588-af25-4c99-a792-89a139d5b381')}
[2025-05-05 16:39:34,036.036] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 16:39:34,036.036] base.py -> _execute_context line:1843 [INFO]: [cached since 4.534s ago] {'coalesce_2': 0, 'document_id_1': UUID('4b666f5e-c37e-490f-8e9f-48fdc1a15009')}
[2025-05-05 16:39:34,037.037] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:39:34,037.037] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:39:34] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 16:41:08,706.706] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:41:09,133.133] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:41:12,821.821] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:41:12,832.832] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:41:19,120.120] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-05-05 16:41:19,483.483] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:41:57,345.345] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 16:41:57,345.345] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 16:41:57,346.346] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:42:00,360.360] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:42:00,371.371] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:44:09,252.252] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/dataset_service.py', reloading
[2025-05-05 16:44:09,657.657] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:44:13,273.273] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:44:13,284.284] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:44:49,247.247] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 16:44:49,247.247] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:44:49,248.248] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 16:44:49,248.248] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:44:49,249.249] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 16:44:49,249.249] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 16:44:49,249.249] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:44:49,252.252] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:44:49,252.252] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00045s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:44:49,257.257] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 16:44:49,258.258] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00038s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 16:44:49,267.267] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 16:44:49,267.267] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:44:49,269.269] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:44:49,269.269] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:44:49] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 16:45:00,642.642] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:45:00,642.642] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:45:00,643.643] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00014s] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,655.655] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:45:00,655.655] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,662.662] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:45:00,664.664] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:45:00,664.664] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:45:00,665.665] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00060s] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,669.669] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 16:45:00,669.669] base.py -> _execute_context line:1843 [INFO]: [cached since 11.42s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 16:45:00,671.671] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 16:45:00,671.671] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 16:45:00,681.681] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 16:45:00,681.681] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'id_1_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,687.687] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 16:45:00,687.687] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00085s] {'keyword_table': '{"4o": ["9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a", "01ca4e56-bada-420b-9494-0c717a86ec58"], "AI": ["b968b2cb-af6 ... (218420 characters truncated) ... "Flask": ["0aa3644d-4d94-48e6-acbc-205d5aaad336"], "cors": ["0aa3644d-4d94-48e6-acbc-205d5aaad336"], "5.0": ["0aa3644d-4d94-48e6-acbc-205d5aaad336"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 16:45:00,710.710] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:45:00,715.715] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:45:00,715.715] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:45:00,716.716] base.py -> _execute_context line:1843 [INFO]: [cached since 0.05143s ago] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,740.740] segment_service.py -> update_segment_enabled line:341 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: 0aa3644d-4d94-48e6-acbc-205d5aaad336, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 16:45:00,746.746] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s, stopped_at=%(stopped_at)s, error=%(error)s, status=%(status)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 16:45:00,746.746] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 16, 45, 0, 745863), 'stopped_at': datetime.datetime(2025, 5, 5, 16, 45, 0, 745870), 'error': 'Object was not updated.! Unexpected status code: 404, with response body: None.', 'status': <SegmentStatus.ERROR: 'error'>, 'segment_id': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:00,747.747] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 16:45:00,748.748] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 56, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 352, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 16:45:00,751.751] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:45:00] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336/enabled HTTP/1.1" 200 -
[2025-05-05 16:45:04,474.474] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 16:45:04,474.474] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 16:45:04,474.474] base.py -> _execute_context line:1843 [INFO]: [cached since 3.832s ago] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 16:45:04,476.476] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 16:45:04,476.476] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:45:04] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336 HTTP/1.1" 200 -
[2025-05-05 16:46:13,602.602] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 16:46:14,040.040] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:50:06,295.295] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 16:50:06,295.295] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 16:50:06,296.296] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:50:09,256.256] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:50:09,267.267] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:50:57,428.428] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-05-05 16:50:57,441.441] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:50:57] "[35m[1mGET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1[0m" 500 -
[2025-05-05 16:51:03,594.594] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: VectorDatabaseService.get_retriever() got an unexpected keyword argument 'search_type'
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py", line 38, in hit
    retriever = self.vector_database_service.get_retriever(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: VectorDatabaseService.get_retriever() got an unexpected keyword argument 'search_type'
[2025-05-05 16:51:03,597.597] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:51:03] "[35m[1mPOST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1[0m" 500 -
[2025-05-05 16:51:53,823.823] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 16:51:54,236.236] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:51:58,086.086] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:51:58,097.097] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 16:52:05,418.418] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 16:52:05,572.572] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 16:52:05,934.934] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: Error during query: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 962, in grpc_search
    res = _Retry(4).with_exponential_backoff(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/retry.py", line 54, in with_exponential_backoff
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/retry.py", line 50, in with_exponential_backoff
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/grpc/_channel.py", line 1181, in __call__
    return _end_unary_response_blocking(state, call, False, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/grpc/_channel.py", line 1006, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384"
	debug_error_string = "UNKNOWN:Error received from peer  {created_time:"2025-05-05T16:52:05.927881+08:00", grpc_status:2, grpc_message:"dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don\'t match: 768 vs 384"}"
>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 274, in _perform_search
    result = collection.query.hybrid(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/queries/hybrid/executors.py", line 300, in hybrid
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 975, in grpc_search
    raise WeaviateQueryError(str(error.details()), "GRPC search")  # pyright: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
weaviate.exceptions.WeaviateQueryError: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py", line 42, in hit
    documents = retriever.invoke(q)
                ^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_core/vectorstores/base.py", line 1086, in _get_relevant_documents
    docs = self.vectorstore.max_marginal_relevance_search(query, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 353, in max_marginal_relevance_search
    return self.max_marginal_relevance_search_by_vector(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 383, in max_marginal_relevance_search_by_vector
    results = self._perform_search(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 278, in _perform_search
    raise ValueError(f"Error during query: {e}")
ValueError: Error during query: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.
[2025-05-05 16:52:05,948.948] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 16:52:05] "[35m[1mPOST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1[0m" 500 -
[2025-05-05 16:52:55,760.760] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 16:52:56,187.187] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 16:52:59,880.880] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 16:52:59,890.890] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:00:15,122.122] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py', reloading
[2025-05-05 17:00:15,591.591] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:00:19,097.097] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:00:19,108.108] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:03:48,315.315] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:03:48] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:04:04,416.416] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:04:04,416.416] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:04:04,417.417] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:04:04,417.417] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:04:04,419.419] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:04:04,419.419] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:04:04,421.421] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:04,423.423] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:04:04,424.424] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00029s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:04,428.428] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:04:04,428.428] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:04,431.431] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-05-05 17:04:04,431.431] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/lf/npfvn1s91v5_k5zdqtnnwp5r0000gn/T/jieba.cache
[2025-05-05 17:04:04,857.857] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.426 seconds.
[2025-05-05 17:04:04,857.857] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-05-05 17:04:04,859.859] base.py -> _execute_context line:1843 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-05-05 17:04:04,860.860] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'document_id': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'node_id': UUID('ceac99ca-485b-4283-a133-20dfb784ddd7'), 'position': 2, 'content': '123221', 'character_count': 6, 'token_count': 2, 'keywords': '["123221"]', 'hash': '661e32992db512c8c0a3b1558812815d7364ae59f97e5a1a6e59737ce890be11', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 5, 5, 17, 4, 4, 858139), 'indexing_completed_at': datetime.datetime(2025, 5, 5, 17, 4, 4, 858142), 'completed_at': datetime.datetime(2025, 5, 5, 17, 4, 4, 858143), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 17:04:04,864.864] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:04,867.867] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:04,868.868] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:04:04,868.868] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:04,873.873] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:04,873.873] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'pk_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:04,876.876] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 17:04:05,092.092] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 17:04:06,502.502] base.py -> __send_batch line:503 [ERROR]: {'message': 'Failed to send all objects in a batch of 1', 'error': "WeaviateInsertManyAllFailedError('Every object failed during insertion. Here is the set of all errors: Validate vector index for ceac99ca-485b-4283-a133-20dfb784ddd7: new node has a vector with length 384. Existing nodes have vectors with length 768')"}
[2025-05-05 17:04:06,502.502] base.py -> __send_batch line:596 [ERROR]: {'message': 'Failed to send 1 objects in a batch of 1. Please inspect client.batch.failed_objects or collection.batch.failed_objects for the failed objects.'}
[2025-05-05 17:04:06,522.522] vectorstores.py -> add_texts line:195 [ERROR]: Failed to add object: None
Reason: WeaviateInsertManyAllFailedError('Every object failed during insertion. Here is the set of all errors: Validate vector index for ceac99ca-485b-4283-a133-20dfb784ddd7: new node has a vector with length 384. Existing nodes have vectors with length 768')
[2025-05-05 17:04:06,523.523] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2025-05-05 17:04:06,523.523] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2025-05-05 17:04:06,526.526] base.py -> _execute_context line:1843 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-05 17:04:06,526.526] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'character_count': 398679, 'token_count': 186345, 'document_id': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:06,527.527] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:06,537.537] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:06,537.537] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:04:06,537.537] base.py -> _execute_context line:1843 [INFO]: [cached since 1.67s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:06,538.538] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:06,539.539] base.py -> _execute_context line:1843 [INFO]: [cached since 1.666s ago] {'pk_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:06,545.545] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 17:04:06,545.545] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00033s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:04:06,551.551] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:04:06,551.551] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00021s] {'id_1_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:06,553.553] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 17:04:06,553.553] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00086s] {'keyword_table': '{"4o": ["9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a", "01ca4e56-bada-420b-9494-0c717a86ec58"], "AI": ["f65a7d4d-8ab ... (218472 characters truncated) ... 3-e9a13d573185", "a1a5702d-1b47-401c-a40d-525904ad995f", "36f39a56-05bf-4d26-a2a7-b7c48973e703"], "123221": ["01b0dbe6-01b5-448c-90b0-e6a043ca8456"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 17:04:06,579.579] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:06,582.582] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:04:06] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:04:12,906.906] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:12,907.907] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:04:12,907.907] base.py -> _execute_context line:1843 [INFO]: [cached since 8.484s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:12,910.910] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:04:12,910.910] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:04:12,913.913] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:04:12,913.913] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00011s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:12,916.916] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:04:12,917.917] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:04:12] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:04:35,358.358] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:35,361.361] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:35,361.361] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00029s] {'pk_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:35,368.368] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 17:04:35,368.368] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 17, 4, 35, 367866), 'segment_id': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:35,369.369] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:35,370.370] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:35,371.371] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:35,371.371] base.py -> _execute_context line:1843 [INFO]: [cached since 30.5s ago] {'pk_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:35,376.376] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:04:35,376.376] base.py -> _execute_context line:1843 [INFO]: [cached since 30.95s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:04:35,380.380] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 17:04:35,380.380] base.py -> _execute_context line:1843 [INFO]: [cached since 28.84s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:04:35,400.400] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 17:04:35,400.400] base.py -> _execute_context line:1843 [INFO]: [cached since 28.85s ago] {'keyword_table': '{"4o": ["9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a", "01ca4e56-bada-420b-9494-0c717a86ec58"], "AI": ["f65a7d4d-8ab ... (218420 characters truncated) ... e0fa"], "AsyncSqliteSaver": ["5864a71f-f3ea-4022-86c3-e9a13d573185", "a1a5702d-1b47-401c-a40d-525904ad995f", "36f39a56-05bf-4d26-a2a7-b7c48973e703"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 17:04:35,467.467] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:35,470.470] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:35,470.470] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:35,470.470] base.py -> _execute_context line:1843 [INFO]: [cached since 30.6s ago] {'pk_1': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:35,477.477] segment_service.py -> update_segment_enabled line:341 [ERROR]: æ›´æ”¹æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å‡ºçŽ°å¼‚å¸¸, segment_id: 01b0dbe6-01b5-448c-90b0-e6a043ca8456, é”™è¯¯ä¿¡æ¯: Object was not updated.! Unexpected status code: 404, with response body: None.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.
[2025-05-05 17:04:35,481.481] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET disabled_at=%(disabled_at)s, stopped_at=%(stopped_at)s, error=%(error)s, status=%(status)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 17:04:35,481.481] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00012s] {'disabled_at': datetime.datetime(2025, 5, 5, 17, 4, 35, 481248), 'stopped_at': datetime.datetime(2025, 5, 5, 17, 4, 35, 481250), 'error': 'Object was not updated.! Unexpected status code: 404, with response body: None.', 'status': <SegmentStatus.ERROR: 'error'>, 'segment_id': UUID('01b0dbe6-01b5-448c-90b0-e6a043ca8456')}
[2025-05-05 17:04:35,482.482] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:04:35,484.484] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 337, in update_segment_enabled
    self.vector_database_service.collection.data.update(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/data/executor.py", line 377, in update
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 792, in patch
    return self._send(
           ^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 704, in _send
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 702, in exc
    self.__handle_exceptions(e, error_msg)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 662, in __handle_exceptions
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 83, in execute
    resp_call = response_callback(call)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 699, in resp
    return self.__handle_response(res, error_msg, status_codes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 670, in __handle_response
    raise UnexpectedStatusCodeError(error_msg, response)
weaviate.exceptions.UnexpectedStatusCodeError: Object was not updated.! Unexpected status code: 404, with response body: None.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 352, in update_segment_enabled
    raise FailException("æ›´æ–°æ–‡æ¡£ç‰‡æ®µå¯ç”¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2025-05-05 17:04:35,488.488] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:04:35] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/01b0dbe6-01b5-448c-90b0-e6a043ca8456/enabled HTTP/1.1" 200 -
[2025-05-05 17:04:41,101.101] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:04:41,102.102] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:04:41,102.102] base.py -> _execute_context line:1843 [INFO]: [cached since 5.742s ago] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 17:04:41,104.104] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:04:41,106.106] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:04:41] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336 HTTP/1.1" 200 -
[2025-05-05 17:06:48,744.744] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:06:49,261.261] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:07:45,512.512] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 17:07:45,513.513] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 17:07:45,514.514] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:07:48,866.866] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:07:48,879.879] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:07:56,293.293] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:07:56,659.659] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:08:00,055.055] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:08:00,112.112] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:08:13,245.245] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:08:13,245.245] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:08:13,246.246] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:08:13,246.246] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:08:13,247.247] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:08:13,247.247] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:08:13,247.247] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:08:13,250.250] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:08:13,250.250] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00033s] {'pk_1': UUID('0aa3644d-4d94-48e6-acbc-205d5aaad336')}
[2025-05-05 17:08:13,255.255] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:08:13,262.262] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:08:13] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments/0aa3644d-4d94-48e6-acbc-205d5aaad336 HTTP/1.1" 200 -
[2025-05-05 17:08:27,716.716] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:08:27,719.719] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:08:27,720.720] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00042s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:08:27,725.725] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:08:27,725.725] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00048s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:08:27,729.729] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:08:27,729.729] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:08:27,731.731] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:08:27,732.732] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:08:27] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:08:44,874.874] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:08:44,877.877] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:08:44,877.877] base.py -> _execute_context line:1843 [INFO]: [cached since 17.16s ago] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:08:44,879.879] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:08:44,879.879] base.py -> _execute_context line:1843 [INFO]: [cached since 17.15s ago] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:08:44,882.882] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:08:44,882.882] base.py -> _execute_context line:1843 [INFO]: [cached since 17.15s ago] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:08:44,883.883] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:08:44,883.883] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:08:44] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:09:07,591.591] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:09:08,047.047] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:09:11,931.931] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:09:11,948.948] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:09:18,215.215] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 17:09:18,358.358] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 17:09:18,687.687] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:09:18] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:09:42,272.272] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:09:42,711.711] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:09:46,335.335] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:09:46,345.345] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:09:47,063.063] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 17:09:47,153.153] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 17:09:47,446.446] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:09:47] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:09:54,849.849] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:09:54,849.849] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:09:54,851.851] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:09:54,851.851] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:09:54,851.851] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:09:54,851.851] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:09:54,852.852] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:09:54,854.854] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:09:54,855.855] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00049s] {'pk_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:09:54,860.860] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:09:54,860.860] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00037s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:09:54,865.865] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:09:54,865.865] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:09:54,867.867] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:09:54,867.867] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:09:54] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/8d9f7d96-5eda-4d60-b7c4-f508559dbc23/segments HTTP/1.1" 200 -
[2025-05-05 17:10:12,090.090] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:10:12,091.091] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:10:12,091.091] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:10:12,097.097] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:10:12,098.098] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00033s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:10:12,106.106] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-05 17:10:12,106.106] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00030s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:10:12,108.108] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,108.108] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:10:12,110.110] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,110.110] base.py -> _execute_context line:1843 [INFO]: [cached since 0.002097s ago] {'coalesce_2': 0, 'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 17:10:12,113.113] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,113.113] base.py -> _execute_context line:1843 [INFO]: [cached since 0.004324s ago] {'coalesce_2': 0, 'document_id_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 17:10:12,114.114] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,114.114] base.py -> _execute_context line:1843 [INFO]: [cached since 0.006111s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ec61ff1-9735-4b1d-a11f-0d3d547a8e5c')}
[2025-05-05 17:10:12,116.116] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,116.116] base.py -> _execute_context line:1843 [INFO]: [cached since 0.007299s ago] {'coalesce_2': 0, 'document_id_1': UUID('6d8dc5ba-6c50-4304-84ab-c7fe4cd42b5e')}
[2025-05-05 17:10:12,116.116] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,116.116] base.py -> _execute_context line:1843 [INFO]: [cached since 0.007944s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1766885-96ae-491c-8d73-4a77219f4086')}
[2025-05-05 17:10:12,117.117] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,117.117] base.py -> _execute_context line:1843 [INFO]: [cached since 0.008499s ago] {'coalesce_2': 0, 'document_id_1': UUID('3a8c6ef2-ac17-457e-b471-1da0943376ab')}
[2025-05-05 17:10:12,117.117] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,117.117] base.py -> _execute_context line:1843 [INFO]: [cached since 0.009018s ago] {'coalesce_2': 0, 'document_id_1': UUID('5518081a-6aa3-4e8b-9276-204a3c03da0f')}
[2025-05-05 17:10:12,118.118] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,118.118] base.py -> _execute_context line:1843 [INFO]: [cached since 0.009684s ago] {'coalesce_2': 0, 'document_id_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 17:10:12,119.119] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,119.119] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01042s ago] {'coalesce_2': 0, 'document_id_1': UUID('5281e628-c5be-4ed3-ae61-e62479b8423c')}
[2025-05-05 17:10:12,120.120] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,120.120] base.py -> _execute_context line:1843 [INFO]: [cached since 0.0114s ago] {'coalesce_2': 0, 'document_id_1': UUID('7ee31973-ec39-44df-ba84-a7073a67c5db')}
[2025-05-05 17:10:12,120.120] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,120.120] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01207s ago] {'coalesce_2': 0, 'document_id_1': UUID('dd4195bc-0960-464c-b415-b4e24fc99fd5')}
[2025-05-05 17:10:12,121.121] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,121.121] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01289s ago] {'coalesce_2': 0, 'document_id_1': UUID('58eba5c9-505e-4b79-a7d5-9f7dd08045f5')}
[2025-05-05 17:10:12,122.122] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,122.122] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01369s ago] {'coalesce_2': 0, 'document_id_1': UUID('e5bd39e5-c889-43b1-bf5d-bfa85110f0b3')}
[2025-05-05 17:10:12,122.122] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,123.123] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01423s ago] {'coalesce_2': 0, 'document_id_1': UUID('eee8706b-e573-4a5f-b58c-9fc28d0587a7')}
[2025-05-05 17:10:12,123.123] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,123.123] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01477s ago] {'coalesce_2': 0, 'document_id_1': UUID('632163f8-e6da-4379-8c13-84a0ee020e56')}
[2025-05-05 17:10:12,124.124] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,124.124] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01536s ago] {'coalesce_2': 0, 'document_id_1': UUID('b63c3fed-6bd6-45a5-bbaa-b16ca297a514')}
[2025-05-05 17:10:12,124.124] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,124.124] base.py -> _execute_context line:1843 [INFO]: [cached since 0.016s ago] {'coalesce_2': 0, 'document_id_1': UUID('11e38a1e-1a9b-4821-828a-ed5009175593')}
[2025-05-05 17:10:12,125.125] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,125.125] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01666s ago] {'coalesce_2': 0, 'document_id_1': UUID('1f12a588-af25-4c99-a792-89a139d5b381')}
[2025-05-05 17:10:12,125.125] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:10:12,125.125] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01716s ago] {'coalesce_2': 0, 'document_id_1': UUID('4b666f5e-c37e-490f-8e9f-48fdc1a15009')}
[2025-05-05 17:10:12,127.127] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:10:12,127.127] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:10:12] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:10:30,444.444] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:10:30,874.874] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:10:34,592.592] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:10:34,604.604] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:10:34,723.723] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 17:10:34,848.848] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 17:10:35,133.133] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:10:35] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:10:36,783.783] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:10:36] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:10:56,561.561] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:10:56,971.971] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:11:00,493.493] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:11:00,522.522] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:11:03,695.695] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:11:04,168.168] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:11:07,522.522] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:11:07,534.534] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:11:07,628.628] oauth.py -> refresh_token line:277 [INFO]: trying to refresh token for ak `uexDJX***`
[2025-05-05 17:11:07,733.733] oauth.py -> refresh_token line:304 [INFO]: successfully refresh token
[2025-05-05 17:11:08,078.078] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: Error during query: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 962, in grpc_search
    res = _Retry(4).with_exponential_backoff(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/retry.py", line 54, in with_exponential_backoff
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/retry.py", line 50, in with_exponential_backoff
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/grpc/_channel.py", line 1181, in __call__
    return _end_unary_response_blocking(state, call, False, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/grpc/_channel.py", line 1006, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384"
	debug_error_string = "UNKNOWN:Error received from peer  {created_time:"2025-05-05T17:11:08.072043+08:00", grpc_status:2, grpc_message:"dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don\'t match: 768 vs 384"}"
>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 274, in _perform_search
    result = collection.query.hybrid(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/collections/queries/hybrid/executors.py", line 300, in hybrid
    return executor.execute(
           ^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 87, in execute
    return cast(T, exception_callback(e))
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 26, in raise_exception
    raise e
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/executor.py", line 68, in execute
    call = method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/weaviate/connect/v4.py", line 975, in grpc_search
    raise WeaviateQueryError(str(error.details()), "GRPC search")  # pyright: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
weaviate.exceptions.WeaviateQueryError: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py", line 52, in hit
    documents = retriever.invoke(q)
                ^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_core/vectorstores/base.py", line 1086, in _get_relevant_documents
    docs = self.vectorstore.max_marginal_relevance_search(query, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 353, in max_marginal_relevance_search
    return self.max_marginal_relevance_search_by_vector(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 383, in max_marginal_relevance_search_by_vector
    results = self._perform_search(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/langchain_weaviate/vectorstores.py", line 278, in _perform_search
    raise ValueError(f"Error during query: {e}")
ValueError: Error during query: Query call with protocol GRPC search failed with message dense search: search index dataset: shard dataset_wh3U3bujy6Lf: vector search: knn search: distance between entrypoint and query node: vector lengths don't match: 768 vs 384.
[2025-05-05 17:11:08,087.087] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:11:08] "[35m[1mPOST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1[0m" 500 -
[2025-05-05 17:11:16,094.094] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:11:16,519.519] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:11:19,967.967] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:11:19,978.978] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:13:26,907.907] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/embeddings_service.py', reloading
[2025-05-05 17:13:27,345.345] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:13:48,889.889] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:13:49,122.122] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:13:49,736.736] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:13:49,737.737] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:13:49,741.741] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:13:49,741.741] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:13:49,742.742] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:13:49,742.742] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:13:49,743.743] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:13:49,745.745] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:13:49,745.745] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:13:49,751.751] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:13:49,751.751] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': '3d8bd984-2744-4aee-8390-246e3da02efe'}
[2025-05-05 17:13:49,754.754] base.py -> _execute_context line:1843 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-05 17:13:49,754.754] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\\n"], "chunk_size": 200, "chunk_overlap": 20}}'}
[2025-05-05 17:13:49,765.765] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:13:49,768.768] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:13:49,769.769] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-05 17:13:49,769.769] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 1}
[2025-05-05 17:13:49,772.772] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 17:13:49,772.772] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'pk_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 17:13:49,780.780] base.py -> _execute_context line:1843 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-05 17:13:49,780.780] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'pk_1': UUID('8ca57d14-a57e-4aa6-b29e-32ffaf81749e')}
[2025-05-05 17:13:49,783.783] base.py -> _execute_context line:1843 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-05 17:13:49,783.783] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'upload_file_id': UUID('3d8bd984-2744-4aee-8390-246e3da02efe'), 'process_rule_id': UUID('8ca57d14-a57e-4aa6-b29e-32ffaf81749e'), 'batch': '20250505171349946927', 'name': 'requirements.txt', 'position': 28, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-05 17:13:49,785.785] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:13:49,792.792] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:13:49,792.792] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:13:49,793.793] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'pk_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:13:50,077.077] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:13:50,079.079] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:13:50] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:13:58,972.972] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:13:58,973.973] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:13:58,973.973] base.py -> _execute_context line:1843 [INFO]: [cached since 9.228s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:13:58,974.974] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-05 17:13:58,974.974] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'batch_1': '20250505171349946927'}
[2025-05-05 17:13:58,980.980] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:13:58,980.980] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:13:58,982.982] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-05 17:13:58,982.982] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 17:13:58,984.984] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 17:13:58,984.984] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00011s] {'id_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 17:13:58,985.985] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:13:58,985.985] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:13:58] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/batch/20250505171349946927 HTTP/1.1" 200 -
[2025-05-05 17:14:23,261.261] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:14:23,263.263] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:14:23,264.264] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00057s] {'pk_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:23,274.274] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:14:23,274.274] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00028s] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:14:23,280.280] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:14:23,280.280] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00031s] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:23,283.283] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:14:23,284.284] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:14:23] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/c990b73f-7572-43f3-8ff7-b2c26017909b/segments HTTP/1.1" 200 -
[2025-05-05 17:14:28,612.612] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:14:28,613.613] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:14:28,613.613] base.py -> _execute_context line:1843 [INFO]: [cached since 38.87s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:14:28,614.614] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:14:28,615.615] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00030s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:14:28,618.618] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-05 17:14:28,619.619] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00039s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:14:28,621.621] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,621.621] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'coalesce_2': 0, 'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:28,622.622] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,622.622] base.py -> _execute_context line:1843 [INFO]: [cached since 0.001232s ago] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:14:28,623.623] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,623.623] base.py -> _execute_context line:1843 [INFO]: [cached since 0.002061s ago] {'coalesce_2': 0, 'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 17:14:28,624.624] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,624.624] base.py -> _execute_context line:1843 [INFO]: [cached since 0.002798s ago] {'coalesce_2': 0, 'document_id_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 17:14:28,624.624] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,624.624] base.py -> _execute_context line:1843 [INFO]: [cached since 0.003481s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ec61ff1-9735-4b1d-a11f-0d3d547a8e5c')}
[2025-05-05 17:14:28,625.625] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,625.625] base.py -> _execute_context line:1843 [INFO]: [cached since 0.00415s ago] {'coalesce_2': 0, 'document_id_1': UUID('6d8dc5ba-6c50-4304-84ab-c7fe4cd42b5e')}
[2025-05-05 17:14:28,626.626] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,626.626] base.py -> _execute_context line:1843 [INFO]: [cached since 0.004758s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1766885-96ae-491c-8d73-4a77219f4086')}
[2025-05-05 17:14:28,626.626] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,626.626] base.py -> _execute_context line:1843 [INFO]: [cached since 0.005267s ago] {'coalesce_2': 0, 'document_id_1': UUID('3a8c6ef2-ac17-457e-b471-1da0943376ab')}
[2025-05-05 17:14:28,627.627] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,627.627] base.py -> _execute_context line:1843 [INFO]: [cached since 0.005767s ago] {'coalesce_2': 0, 'document_id_1': UUID('5518081a-6aa3-4e8b-9276-204a3c03da0f')}
[2025-05-05 17:14:28,628.628] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,628.628] base.py -> _execute_context line:1843 [INFO]: [cached since 0.00663s ago] {'coalesce_2': 0, 'document_id_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 17:14:28,628.628] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,629.629] base.py -> _execute_context line:1843 [INFO]: [cached since 0.007551s ago] {'coalesce_2': 0, 'document_id_1': UUID('5281e628-c5be-4ed3-ae61-e62479b8423c')}
[2025-05-05 17:14:28,629.629] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,629.629] base.py -> _execute_context line:1843 [INFO]: [cached since 0.008484s ago] {'coalesce_2': 0, 'document_id_1': UUID('7ee31973-ec39-44df-ba84-a7073a67c5db')}
[2025-05-05 17:14:28,630.630] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,630.630] base.py -> _execute_context line:1843 [INFO]: [cached since 0.009187s ago] {'coalesce_2': 0, 'document_id_1': UUID('dd4195bc-0960-464c-b415-b4e24fc99fd5')}
[2025-05-05 17:14:28,631.631] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,631.631] base.py -> _execute_context line:1843 [INFO]: [cached since 0.009895s ago] {'coalesce_2': 0, 'document_id_1': UUID('58eba5c9-505e-4b79-a7d5-9f7dd08045f5')}
[2025-05-05 17:14:28,632.632] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,632.632] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01071s ago] {'coalesce_2': 0, 'document_id_1': UUID('e5bd39e5-c889-43b1-bf5d-bfa85110f0b3')}
[2025-05-05 17:14:28,632.632] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,632.632] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01124s ago] {'coalesce_2': 0, 'document_id_1': UUID('eee8706b-e573-4a5f-b58c-9fc28d0587a7')}
[2025-05-05 17:14:28,633.633] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,633.633] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01176s ago] {'coalesce_2': 0, 'document_id_1': UUID('632163f8-e6da-4379-8c13-84a0ee020e56')}
[2025-05-05 17:14:28,633.633] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,633.633] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01245s ago] {'coalesce_2': 0, 'document_id_1': UUID('b63c3fed-6bd6-45a5-bbaa-b16ca297a514')}
[2025-05-05 17:14:28,634.634] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,634.634] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01302s ago] {'coalesce_2': 0, 'document_id_1': UUID('11e38a1e-1a9b-4821-828a-ed5009175593')}
[2025-05-05 17:14:28,634.634] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:28,635.635] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01353s ago] {'coalesce_2': 0, 'document_id_1': UUID('1f12a588-af25-4c99-a792-89a139d5b381')}
[2025-05-05 17:14:28,636.636] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:14:28,636.636] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:14:28] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:14:45,885.885] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:14:45,886.886] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:14:45,886.886] base.py -> _execute_context line:1843 [INFO]: [cached since 22.62s ago] {'pk_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:45,888.888] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:45,888.888] base.py -> _execute_context line:1843 [INFO]: [cached since 46.91s ago] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:45,889.889] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:14:45,889.889] base.py -> _execute_context line:1843 [INFO]: [cached since 17.27s ago] {'coalesce_2': 0, 'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:45,892.892] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:14:45,893.893] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:14:45] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/c990b73f-7572-43f3-8ff7-b2c26017909b HTTP/1.1" 200 -
[2025-05-05 17:14:55,697.697] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:14:55,698.698] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:14:55,698.698] base.py -> _execute_context line:1843 [INFO]: [cached since 32.43s ago] {'pk_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:55,699.699] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:14:55,700.700] base.py -> _execute_context line:1843 [INFO]: [cached since 32.43s ago] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:14:55,701.701] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:14:55,701.701] base.py -> _execute_context line:1843 [INFO]: [cached since 32.42s ago] {'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:14:55,702.702] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:14:55,702.702] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:14:55] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/c990b73f-7572-43f3-8ff7-b2c26017909b/segments HTTP/1.1" 200 -
[2025-05-05 17:15:27,873.873] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:15:28,978.978] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:15:48,378.378] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:15:48,427.427] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:15:50,092.092] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:15:50] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:16:27,039.039] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:16:28,116.116] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:16:47,501.501] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:16:47,525.525] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:16:48,578.578] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:16:48] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:17:27,636.636] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:17:28,663.663] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:17:48,292.292] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:17:48,320.320] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:17:49,461.461] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:17:49] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:18:36,120.120] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:18:36,121.121] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:18:36,123.123] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:18:36,123.123] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:18:36,124.124] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:18:36,124.124] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:18:36,124.124] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:18:36,127.127] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:18:36,127.127] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00031s] {'pk_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:18:36,132.132] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:18:36,132.132] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:18:36,135.135] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:18:36,135.135] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'coalesce_2': 0, 'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:18:36,136.136] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:18:36,137.137] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:18:36] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/a4958fcf-f859-4f2c-8f1f-d4738e186e13 HTTP/1.1" 200 -
[2025-05-05 17:19:17,417.417] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:19:17,424.424] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:19:17,425.425] base.py -> _execute_context line:1843 [INFO]: [cached since 41.3s ago] {'pk_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:19:17,432.432] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:19:17,433.433] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:19:17,438.438] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:19:17,440.440] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00186s] {'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:19:17,446.446] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:19:17,447.447] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:19:17] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/a4958fcf-f859-4f2c-8f1f-d4738e186e13/segments HTTP/1.1" 200 -
[2025-05-05 17:19:52,554.554] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:19:52,559.559] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:19:52,559.559] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:19:52,565.565] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:19:52,565.565] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00023s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:19:52,760.760] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-05 17:19:52,761.761] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00040s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:19:52,762.762] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,762.762] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('c990b73f-7572-43f3-8ff7-b2c26017909b')}
[2025-05-05 17:19:52,764.764] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,764.764] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('8d9f7d96-5eda-4d60-b7c4-f508559dbc23')}
[2025-05-05 17:19:52,765.765] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,766.766] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('acf1533e-8098-4c11-aac8-7bfb430ac40d')}
[2025-05-05 17:19:52,766.766] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,766.766] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('b98ed149-b7a8-4356-a218-ae5692cec3bc')}
[2025-05-05 17:19:52,767.767] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,767.767] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ec61ff1-9735-4b1d-a11f-0d3d547a8e5c')}
[2025-05-05 17:19:52,768.768] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,768.768] base.py -> _execute_context line:1843 [INFO]: [cached since 76.63s ago] {'coalesce_2': 0, 'document_id_1': UUID('6d8dc5ba-6c50-4304-84ab-c7fe4cd42b5e')}
[2025-05-05 17:19:52,771.771] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,771.771] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1766885-96ae-491c-8d73-4a77219f4086')}
[2025-05-05 17:19:52,772.772] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,772.772] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('3a8c6ef2-ac17-457e-b471-1da0943376ab')}
[2025-05-05 17:19:52,773.773] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,773.773] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('5518081a-6aa3-4e8b-9276-204a3c03da0f')}
[2025-05-05 17:19:52,773.773] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,774.774] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('e2757cbf-60c3-43be-be03-d3b20a5eb365')}
[2025-05-05 17:19:52,774.774] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,774.774] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('5281e628-c5be-4ed3-ae61-e62479b8423c')}
[2025-05-05 17:19:52,775.775] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,775.775] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('7ee31973-ec39-44df-ba84-a7073a67c5db')}
[2025-05-05 17:19:52,776.776] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,776.776] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('dd4195bc-0960-464c-b415-b4e24fc99fd5')}
[2025-05-05 17:19:52,777.777] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,777.777] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('58eba5c9-505e-4b79-a7d5-9f7dd08045f5')}
[2025-05-05 17:19:52,778.778] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,778.778] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('e5bd39e5-c889-43b1-bf5d-bfa85110f0b3')}
[2025-05-05 17:19:52,778.778] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,778.778] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('eee8706b-e573-4a5f-b58c-9fc28d0587a7')}
[2025-05-05 17:19:52,779.779] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,779.779] base.py -> _execute_context line:1843 [INFO]: [cached since 76.64s ago] {'coalesce_2': 0, 'document_id_1': UUID('632163f8-e6da-4379-8c13-84a0ee020e56')}
[2025-05-05 17:19:52,780.780] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,780.780] base.py -> _execute_context line:1843 [INFO]: [cached since 76.65s ago] {'coalesce_2': 0, 'document_id_1': UUID('b63c3fed-6bd6-45a5-bbaa-b16ca297a514')}
[2025-05-05 17:19:52,781.781] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,781.781] base.py -> _execute_context line:1843 [INFO]: [cached since 76.65s ago] {'coalesce_2': 0, 'document_id_1': UUID('11e38a1e-1a9b-4821-828a-ed5009175593')}
[2025-05-05 17:19:52,782.782] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:52,782.782] base.py -> _execute_context line:1843 [INFO]: [cached since 76.65s ago] {'coalesce_2': 0, 'document_id_1': UUID('1f12a588-af25-4c99-a792-89a139d5b381')}
[2025-05-05 17:19:52,783.783] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:19:52,784.784] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:19:52] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:19:58,189.189] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:19:58,189.189] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:19:58,189.189] base.py -> _execute_context line:1843 [INFO]: [cached since 82.06s ago] {'pk_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:19:58,200.200] base.py -> _execute_context line:1843 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:58,200.200] base.py -> _execute_context line:1843 [INFO]: [cached since 82.07s ago] {'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:19:58,202.202] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:19:58,202.202] base.py -> _execute_context line:1843 [INFO]: [cached since 82.07s ago] {'coalesce_2': 0, 'document_id_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 17:19:58,203.203] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:19:58,203.203] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:19:58] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/a4958fcf-f859-4f2c-8f1f-d4738e186e13 HTTP/1.1" 200 -
[2025-05-05 17:20:13,549.549] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:20:13,555.555] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:20:13,555.555] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00145s] {'pk_1': UUID('7eb9382c-5264-4b39-9988-f62291aa7d85')}
[2025-05-05 17:20:13,558.558] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:20:13,559.559] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:20:13] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/a4958fcf-f859-4f2c-8f1f-d4738e186e13/segments/7eb9382c-5264-4b39-9988-f62291aa7d85 HTTP/1.1" 200 -
[2025-05-05 17:20:36,598.598] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:20:36,599.599] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:20:36,599.599] base.py -> _execute_context line:1843 [INFO]: [cached since 23.04s ago] {'pk_1': UUID('7eb9382c-5264-4b39-9988-f62291aa7d85')}
[2025-05-05 17:20:36,601.601] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 301, in update_segment_enabled
    raise FailException("å½“å‰ç‰‡æ®µä¸å¯ä¿®æ”¹çŠ¶æ€ï¼Œè¯·ç¨åŽå°è¯•")
internal.exception.exception.FailException
[2025-05-05 17:20:36,603.603] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:20:36,604.604] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:20:36] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/a4958fcf-f859-4f2c-8f1f-d4738e186e13/segments/7eb9382c-5264-4b39-9988-f62291aa7d85/enabled HTTP/1.1" 200 -
[2025-05-05 17:20:53,077.077] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:20:53] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:21:04,044.044] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:21:05,385.385] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:21:25,278.278] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:21:25,308.308] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:21:27,021.021] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:21:27] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:23:24,201.201] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/indexing_service.py', reloading
[2025-05-05 17:23:25,118.118] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:23:45,017.017] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:23:45,060.060] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:23:45,279.279] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:23:45,280.280] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:23:45,281.281] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:23:45,281.281] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:23:45,283.283] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:23:45,283.283] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:23:45,283.283] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:23:45,285.285] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:23:45,285.285] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:23:45,288.288] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:23:45,289.289] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00020s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': '3d8bd984-2744-4aee-8390-246e3da02efe'}
[2025-05-05 17:23:45,291.291] base.py -> _execute_context line:1843 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-05 17:23:45,291.291] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\\n"], "chunk_size": 200, "chunk_overlap": 20}}'}
[2025-05-05 17:23:45,296.296] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:23:45,298.298] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:23:45,299.299] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-05 17:23:45,299.299] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00026s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 1}
[2025-05-05 17:23:45,304.304] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 17:23:45,304.304] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00015s] {'pk_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 17:23:45,305.305] base.py -> _execute_context line:1843 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-05 17:23:45,305.305] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00008s] {'pk_1': UUID('ffdccac2-5294-4b47-a002-e938f3f1d29d')}
[2025-05-05 17:23:45,306.306] base.py -> _execute_context line:1843 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-05 17:23:45,306.306] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00012s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'upload_file_id': UUID('3d8bd984-2744-4aee-8390-246e3da02efe'), 'process_rule_id': UUID('ffdccac2-5294-4b47-a002-e938f3f1d29d'), 'batch': '20250505172345977190', 'name': 'requirements.txt', 'position': 29, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-05 17:23:45,308.308] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:23:45,313.313] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:23:45,313.313] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:23:45,313.313] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'pk_1': UUID('80dea40b-794e-4d93-829e-a0d6784d8254')}
[2025-05-05 17:23:45,495.495] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:23:45,496.496] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:23:45] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:25:24,400.400] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:25:24,402.402] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 17:25:24,403.403] base.py -> _execute_context line:1843 [INFO]: [cached since 99.12s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:25:24,423.423] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:25:24,423.423] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': '3d8bd984-2744-4aee-8390-246e3da02efe'}
[2025-05-05 17:25:24,426.426] base.py -> _execute_context line:1843 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-05 17:25:24,426.426] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\\n"], "chunk_size": 200, "chunk_overlap": 20}}'}
[2025-05-05 17:25:24,432.432] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:25:24,436.436] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:25:24,436.436] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-05 17:25:24,436.436] base.py -> _execute_context line:1843 [INFO]: [cached since 99.14s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'param_1': 1}
[2025-05-05 17:25:24,438.438] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-05 17:25:24,438.438] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'pk_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 17:25:24,439.439] base.py -> _execute_context line:1843 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-05 17:25:24,439.439] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'pk_1': UUID('1c76f28b-8da7-43a3-990c-3242ab343aa9')}
[2025-05-05 17:25:24,440.440] base.py -> _execute_context line:1843 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-05 17:25:24,440.440] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'upload_file_id': UUID('3d8bd984-2744-4aee-8390-246e3da02efe'), 'process_rule_id': UUID('1c76f28b-8da7-43a3-990c-3242ab343aa9'), 'batch': '20250505172524330484', 'name': 'requirements.txt', 'position': 30, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-05 17:25:24,442.442] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:25:24,442.442] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:25:24,443.443] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:25:24,443.443] base.py -> _execute_context line:1843 [INFO]: [cached since 99.13s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:25:24,474.474] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:25:24,479.479] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:25:24] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents HTTP/1.1" 200 -
[2025-05-05 17:25:55,444.444] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:25:55,446.446] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:25:55,446.446] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00030s] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:25:55,453.453] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:25:55,453.453] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'document_id_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:25:55,462.462] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:25:55,462.462] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00012s] {'document_id_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:25:55,464.464] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:25:55,464.464] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:25:55] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments HTTP/1.1" 200 -
[2025-05-05 17:26:09,580.580] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:26:10,705.705] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:26:31,689.689] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:26:31,713.713] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:26:33,653.653] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:26:33] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:26:49,912.912] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 17:26:49,912.912] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:26:49,913.913] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 17:26:49,913.913] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:26:49,913.913] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 17:26:49,913.913] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 17:26:49,914.914] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:26:49,916.916] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:26:49,916.916] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00016s] {'pk_1': UUID('7eb9382c-5264-4b39-9988-f62291aa7d85')}
[2025-05-05 17:26:49,918.918] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 52, in get_segment
    segment = self.segment_service.get_segment(dataset_id, document_id, segment_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 281, in get_segment
    raise NotFoundException("è¯¥æ–‡æ¡£ç‰‡æ®µä¸å­˜åœ¨ï¼Œæˆ–æ— æƒé™æŸ¥çœ‹ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-05-05 17:26:49,921.921] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:26:49,921.921] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:26:49] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/7eb9382c-5264-4b39-9988-f62291aa7d85 HTTP/1.1" 200 -
[2025-05-05 17:26:53,847.847] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:26:53,849.849] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:26:53,849.849] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00021s] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:26:53,853.853] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-05 17:26:53,853.853] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00037s] {'document_id_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739'), 'param_1': 20, 'param_2': 0}
[2025-05-05 17:26:53,857.857] base.py -> _execute_context line:1843 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-05 17:26:53,857.857] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00018s] {'document_id_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:26:53,859.859] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:26:53,859.859] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:26:53] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments HTTP/1.1" 200 -
[2025-05-05 17:27:03,424.424] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:03,425.425] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:03,426.426] base.py -> _execute_context line:1843 [INFO]: [cached since 13.51s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:03,427.427] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:27:03,428.428] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:27:03] "GET /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/4d6571f5-31aa-44a6-a2dd-89f033882e24 HTTP/1.1" 200 -
[2025-05-05 17:27:11,128.128] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:11,128.128] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:11,129.129] base.py -> _execute_context line:1843 [INFO]: [cached since 21.21s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:11,130.130] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 305, in update_segment_enabled
    raise FailException(
internal.exception.exception.FailException
[2025-05-05 17:27:11,130.130] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:27:11,131.131] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:27:11] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/4d6571f5-31aa-44a6-a2dd-89f033882e24/enabled HTTP/1.1" 200 -
[2025-05-05 17:27:15,667.667] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:15,668.668] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:15,668.668] base.py -> _execute_context line:1843 [INFO]: [cached since 25.75s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:15,677.677] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 17:27:15,677.677] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 5, 17, 27, 15, 676221), 'segment_id': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:15,679.679] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:27:15,680.680] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:15,681.681] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:15,681.681] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:15,683.683] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:27:15,683.683] base.py -> _execute_context line:1843 [INFO]: [cached since 21.83s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:27:15,687.687] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 17:27:15,687.687] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00017s] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:27:15,697.697] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 17:27:15,697.697] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00077s] {'keyword_table': '{"4o": ["9058b36b-47d9-4de0-9d04-965f494e5d46", "01ca4e56-bada-420b-9494-0c717a86ec58", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["5d8080ba-8f3 ... (219220 characters truncated) ... e4e5"], "AsyncSqliteSaver": ["a1a5702d-1b47-401c-a40d-525904ad995f", "36f39a56-05bf-4d26-a2a7-b7c48973e703", "5864a71f-f3ea-4022-86c3-e9a13d573185"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 17:27:15,727.727] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:27:15,729.729] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:15,729.729] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:15,729.729] base.py -> _execute_context line:1843 [INFO]: [cached since 0.0483s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:15,742.742] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:27:15,742.742] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:27:15] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/4d6571f5-31aa-44a6-a2dd-89f033882e24/enabled HTTP/1.1" 200 -
[2025-05-05 17:27:21,885.885] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:21,885.885] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:21,885.885] base.py -> _execute_context line:1843 [INFO]: [cached since 31.97s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:21,889.889] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-05 17:27:21,889.889] base.py -> _execute_context line:1843 [INFO]: [cached since 6.212s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:21,890.890] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:27:21,890.890] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:21,890.890] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:21,891.891] base.py -> _execute_context line:1843 [INFO]: [cached since 6.21s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:21,891.891] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:27:21,891.891] base.py -> _execute_context line:1843 [INFO]: [cached since 28.04s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:27:21,893.893] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 17:27:21,893.893] base.py -> _execute_context line:1843 [INFO]: [cached since 6.206s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:27:21,898.898] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:27:21,899.899] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00025s] {'id_1_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:21,900.900] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 17:27:21,900.900] base.py -> _execute_context line:1843 [INFO]: [cached since 6.204s ago] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["fe1e8f34-131 ... (219620 characters truncated) ... e0fa"], "AsyncSqliteSaver": ["36f39a56-05bf-4d26-a2a7-b7c48973e703", "5864a71f-f3ea-4022-86c3-e9a13d573185", "a1a5702d-1b47-401c-a40d-525904ad995f"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 17:27:21,921.921] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:27:21,924.924] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:21,924.924] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:21,924.924] base.py -> _execute_context line:1843 [INFO]: [cached since 6.243s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:21,934.934] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:27:21,934.934] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:27:21] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/4d6571f5-31aa-44a6-a2dd-89f033882e24/enabled HTTP/1.1" 200 -
[2025-05-05 17:27:23,459.459] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:27:23,459.459] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:27:23,459.459] base.py -> _execute_context line:1843 [INFO]: [cached since 33.54s ago] {'pk_1': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 17:27:23,460.460] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/segment_service.py", line 305, in update_segment_enabled
    raise FailException(
internal.exception.exception.FailException
[2025-05-05 17:27:23,460.460] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 17:27:23,460.460] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:27:23] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments/4d6571f5-31aa-44a6-a2dd-89f033882e24/enabled HTTP/1.1" 200 -
[2025-05-05 17:28:50,569.569] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:28:50,573.573] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:28:50,573.573] base.py -> _execute_context line:1843 [INFO]: [cached since 116.7s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:28:50,576.576] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-05 17:28:50,577.577] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00012s] {'coalesce_2': 0, 'document_id_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:28:50,582.582] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-05-05 17:28:50,582.582] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/lf/npfvn1s91v5_k5zdqtnnwp5r0000gn/T/jieba.cache
[2025-05-05 17:28:50,999.999] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.418 seconds.
[2025-05-05 17:28:51,000.000] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-05-05 17:28:51,001.001] base.py -> _execute_context line:1843 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-05-05 17:28:51,001.001] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'account_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'dataset_id': UUID('46e14707-57d6-421e-8e6d-fff953592f2b'), 'document_id': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739'), 'node_id': UUID('f596f1ed-25ed-4682-a5f8-2d3e949d8ebc'), 'position': 2, 'content': '123221', 'character_count': 6, 'token_count': 2, 'keywords': '["123221"]', 'hash': '661e32992db512c8c0a3b1558812815d7364ae59f97e5a1a6e59737ce890be11', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 5, 5, 17, 28, 51, 398), 'indexing_completed_at': datetime.datetime(2025, 5, 5, 17, 28, 51, 400), 'completed_at': datetime.datetime(2025, 5, 5, 17, 28, 51, 401), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-05 17:28:51,007.007] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:28:51,008.008] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:28:51,008.008] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:28:51,008.008] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:28:51,010.010] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:28:51,010.010] base.py -> _execute_context line:1843 [INFO]: [cached since 95.33s ago] {'pk_1': UUID('a207eb22-dee4-4e5b-aabf-db546d70d8c4')}
[2025-05-05 17:28:52,910.910] base.py -> _execute_context line:1843 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2025-05-05 17:28:52,910.910] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2025-05-05 17:28:52,915.915] base.py -> _execute_context line:1843 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-05 17:28:52,915.915] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00014s] {'character_count': 399774, 'token_count': 186881, 'document_id': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:28:52,916.916] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:28:52,917.917] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 17:28:52,917.917] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 17:28:52,917.917] base.py -> _execute_context line:1843 [INFO]: [cached since 1.904s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 17:28:52,920.920] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-05 17:28:52,921.921] base.py -> _execute_context line:1843 [INFO]: [cached since 97.24s ago] {'pk_1': UUID('a207eb22-dee4-4e5b-aabf-db546d70d8c4')}
[2025-05-05 17:28:52,925.925] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-05 17:28:52,926.926] base.py -> _execute_context line:1843 [INFO]: [cached since 97.23s ago] {'dataset_id_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 17:28:52,933.933] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 17:28:52,933.933] base.py -> _execute_context line:1843 [INFO]: [cached since 91.03s ago] {'id_1_1': UUID('a207eb22-dee4-4e5b-aabf-db546d70d8c4')}
[2025-05-05 17:28:52,935.935] base.py -> _execute_context line:1843 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-05 17:28:52,935.935] base.py -> _execute_context line:1843 [INFO]: [cached since 97.23s ago] {'keyword_table': '{"4o": ["01ca4e56-bada-420b-9494-0c717a86ec58", "9058b36b-47d9-4de0-9d04-965f494e5d46", "d90e2762-1710-4ef6-a441-226da3100f3a"], "AI": ["fe1e8f34-131 ... (219672 characters truncated) ... 7-b7c48973e703", "5864a71f-f3ea-4022-86c3-e9a13d573185", "a1a5702d-1b47-401c-a40d-525904ad995f"], "123221": ["a207eb22-dee4-4e5b-aabf-db546d70d8c4"]}', 'keyword_table_id': UUID('e8e39665-51ba-457c-be8c-bb55d1a33769')}
[2025-05-05 17:28:52,967.967] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 17:28:52,972.972] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:28:52] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/documents/3ef2cc4a-2608-45a2-9c62-fc8520a35739/segments HTTP/1.1" 200 -
[2025-05-05 17:29:01,866.866] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 17:29:02,943.943] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:29:23,458.458] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:29:23,496.496] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:29:25,023.023] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 17:29:25] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 17:32:20,178.178] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/vector_database_service.py', reloading
[2025-05-05 17:32:21,682.682] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:32:42,305.305] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:32:42,324.324] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 17:33:03,694.694] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/vector_database_service.py', reloading
[2025-05-05 17:33:04,661.661] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:37:10,265.265] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 17:37:10,266.266] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 17:37:10,267.267] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 17:37:31,043.043] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 17:37:31,061.061] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:17:31,964.964] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:17:32,014.014] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:17:53,523.523] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-05-05 18:18:15,164.164] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:18:15,182.182] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:18:21,709.709] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-05-05 18:18:42,772.772] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:18:42,787.787] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:19:03,371.371] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/schema/__init__.py', reloading
[2025-05-05 18:19:25,323.323] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:19:25,341.341] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:19:49,999.999] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-05-05 18:20:11,114.114] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:20:11,155.155] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:21:11,332.332] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-05-05 18:30:57,093.093] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 18:30:57,093.093] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 18:30:57,094.094] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 18:31:18,498.498] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:31:18,520.520] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:32:03,416.416] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-05-05 18:32:04,501.501] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 18:32:25,853.853] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:32:25,874.874] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:32:56,940.940] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/service/dataset_service.py', reloading
[2025-05-05 18:32:57,965.965] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 18:36:04,179.179] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-05 18:36:04,179.179] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-05 18:36:04,180.180] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-05 18:36:27,022.022] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-05 18:36:27,044.044] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 129-308-032
[2025-05-05 18:41:21,760.760] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:41:21] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 18:41:31,834.834] http.py -> _register_error_handler line:57 [ERROR]: An error occurred: 400 Bad Request: Failed to decode JSON object: Expecting property name enclosed in double quotes: line 2 column 5 (char 6)
Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 611, in get_json
    rv = self.json_module.loads(data)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/json/provider.py", line 187, in loads
    return json.loads(s, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.10/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.10/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/decoder.py", line 338, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.10/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/decoder.py", line 354, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 2 column 5 (char 6)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/internal/handler/dataset_handler.py", line 37, in hit
    req = HitReq()
          ^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/wtforms/form.py", line 209, in __call__
    return type.__call__(cls, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask_wtf/form.py", line 73, in __init__
    super().__init__(formdata=formdata, **kwargs)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/wtforms/form.py", line 287, in __init__
    self.process(formdata, obj, data=data, **kwargs)
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/wtforms/form.py", line 107, in process
    formdata = self.meta.wrap_formdata(self, formdata)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask_wtf/form.py", line 60, in wrap_formdata
    return ImmutableMultiDict(request.get_json())
                              ^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 620, in get_json
    rv = self.on_json_loading_failed(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/flask/wrappers.py", line 214, in on_json_loading_failed
    return super().on_json_loading_failed(e)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wangqun/Desktop/ai/llmops/llmops-api/env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 645, in on_json_loading_failed
    raise BadRequest(f"Failed to decode JSON object: {e}")
werkzeug.exceptions.BadRequest: 400 Bad Request: Failed to decode JSON object: Expecting property name enclosed in double quotes: line 2 column 5 (char 6)
[2025-05-05 18:41:31,849.849] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:41:31] "[35m[1mPOST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1[0m" 500 -
[2025-05-05 18:41:41,660.660] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:41:41] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 18:42:24,791.791] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:42:24] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 18:42:33,088.088] base.py -> _execute_context line:1843 [INFO]: select pg_catalog.version()
[2025-05-05 18:42:33,088.088] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 18:42:33,093.093] base.py -> _execute_context line:1843 [INFO]: select current_schema()
[2025-05-05 18:42:33,094.094] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 18:42:33,095.095] base.py -> _execute_context line:1843 [INFO]: show standard_conforming_strings
[2025-05-05 18:42:33,095.095] base.py -> _execute_context line:1843 [INFO]: [raw sql] {}
[2025-05-05 18:42:33,096.096] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:42:33,099.099] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 18:42:33,099.099] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:42:33,110.110] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-05 18:42:33,111.111] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00028s] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:42:34,268.268] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-05-05 18:42:34,268.268] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/lf/npfvn1s91v5_k5zdqtnnwp5r0000gn/T/jieba.cache
[2025-05-05 18:42:34,695.695] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.426 seconds.
[2025-05-05 18:42:34,695.695] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-05-05 18:42:34,697.697] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-05 18:42:34,697.697] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00019s] {'dataset_id_1_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:42:34,718.718] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-05 18:42:34,718.718] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00038s] {}
[2025-05-05 18:42:34,722.722] base.py -> _execute_context line:1843 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-05 18:42:34,722.722] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00011s] {'dataset_id': '46e14707-57d6-421e-8e6d-fff953592f2b', 'query': 'æ•°å­—', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': 'f47ac10b-58cc-4372-a567-0e02b2c3d479'}
[2025-05-05 18:42:34,748.748] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 18:42:34,751.751] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:42:34,752.752] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID)
[2025-05-05 18:42:34,752.752] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00013s] {'hit_count_1': 1, 'id_1_1': UUID('3d9304c1-dd48-49cc-8151-6acf4fae7e0b'), 'id_1_2': UUID('a207eb22-dee4-4e5b-aabf-db546d70d8c4'), 'id_1_3': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 18:42:34,766.766] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 18:42:34,768.768] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:42:34,768.768] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID)
[2025-05-05 18:42:34,768.768] base.py -> _execute_context line:1843 [INFO]: [cached since 0.05025s ago] {'id_1_1': '3d9304c1-dd48-49cc-8151-6acf4fae7e0b', 'id_1_2': 'a207eb22-dee4-4e5b-aabf-db546d70d8c4', 'id_1_3': '4d6571f5-31aa-44a6-a2dd-89f033882e24'}
[2025-05-05 18:42:34,781.781] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 18:42:34,781.781] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00024s] {'pk_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 18:42:34,783.783] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:42:34,783.783] base.py -> _execute_context line:1843 [INFO]: [generated in 0.00011s] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 18:42:34,792.792] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 18:42:34,792.792] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01071s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 18:42:34,798.798] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:42:34,799.799] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01524s ago] {'id_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 18:42:34,799.799] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:42:34,799.799] base.py -> _execute_context line:1843 [INFO]: [cached since 0.01609s ago] {'id_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 18:42:34,800.800] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 18:42:34,806.806] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:42:34] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
[2025-05-05 18:43:03,873.873] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:43:03,874.874] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-05 18:43:03,874.874] base.py -> _execute_context line:1843 [INFO]: [cached since 30.78s ago] {'pk_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:43:03,877.877] base.py -> _execute_context line:1843 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-05 18:43:03,878.878] base.py -> _execute_context line:1843 [INFO]: [cached since 30.77s ago] {'account_id_1': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'id_1_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:43:04,818.818] base.py -> _execute_context line:1843 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-05 18:43:04,818.818] base.py -> _execute_context line:1843 [INFO]: [cached since 30.12s ago] {'dataset_id_1_1': UUID('46e14707-57d6-421e-8e6d-fff953592f2b')}
[2025-05-05 18:43:04,829.829] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-05 18:43:04,829.829] base.py -> _execute_context line:1843 [INFO]: [cached since 30.11s ago] {'id_1_1': 'a207eb22-dee4-4e5b-aabf-db546d70d8c4'}
[2025-05-05 18:43:04,831.831] base.py -> _execute_context line:1843 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-05 18:43:04,831.831] base.py -> _execute_context line:1843 [INFO]: [cached since 30.11s ago] {'dataset_id': '46e14707-57d6-421e-8e6d-fff953592f2b', 'query': '123221', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': 'f47ac10b-58cc-4372-a567-0e02b2c3d479'}
[2025-05-05 18:43:04,832.832] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 18:43:04,834.834] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:43:04,836.836] base.py -> _execute_context line:1843 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID)
[2025-05-05 18:43:04,836.836] base.py -> _execute_context line:1843 [INFO]: [cached since 30.08s ago] {'hit_count_1': 1, 'id_1_1': UUID('a207eb22-dee4-4e5b-aabf-db546d70d8c4'), 'id_1_2': UUID('3d9304c1-dd48-49cc-8151-6acf4fae7e0b'), 'id_1_3': UUID('4d6571f5-31aa-44a6-a2dd-89f033882e24')}
[2025-05-05 18:43:04,838.838] base.py -> _connection_commit_impl line:2705 [INFO]: COMMIT
[2025-05-05 18:43:04,839.839] base.py -> _connection_begin_impl line:2699 [INFO]: BEGIN (implicit)
[2025-05-05 18:43:04,839.839] base.py -> _execute_context line:1843 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID)
[2025-05-05 18:43:04,841.841] base.py -> _execute_context line:1843 [INFO]: [cached since 30.12s ago] {'id_1_1': 'a207eb22-dee4-4e5b-aabf-db546d70d8c4', 'id_1_2': '3d9304c1-dd48-49cc-8151-6acf4fae7e0b', 'id_1_3': '4d6571f5-31aa-44a6-a2dd-89f033882e24'}
[2025-05-05 18:43:04,842.842] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 18:43:04,843.843] base.py -> _execute_context line:1843 [INFO]: [cached since 30.06s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 18:43:04,844.844] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:43:04,844.844] base.py -> _execute_context line:1843 [INFO]: [cached since 30.06s ago] {'id_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 18:43:04,846.846] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 18:43:04,846.846] base.py -> _execute_context line:1843 [INFO]: [cached since 30.07s ago] {'pk_1': UUID('a4958fcf-f859-4f2c-8f1f-d4738e186e13')}
[2025-05-05 18:43:04,849.849] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:43:04,849.849] base.py -> _execute_context line:1843 [INFO]: [cached since 30.07s ago] {'id_1': UUID('94acfe76-bbad-4d4c-9751-bfcd36bca124')}
[2025-05-05 18:43:04,850.850] base.py -> _execute_context line:1843 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-05 18:43:04,850.850] base.py -> _execute_context line:1843 [INFO]: [cached since 30.07s ago] {'pk_1': UUID('3ef2cc4a-2608-45a2-9c62-fc8520a35739')}
[2025-05-05 18:43:04,851.851] base.py -> _execute_context line:1843 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-05 18:43:04,851.851] base.py -> _execute_context line:1843 [INFO]: [cached since 30.07s ago] {'id_1': UUID('3d8bd984-2744-4aee-8390-246e3da02efe')}
[2025-05-05 18:43:04,852.852] base.py -> _connection_rollback_impl line:2702 [INFO]: ROLLBACK
[2025-05-05 18:43:04,853.853] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [05/May/2025 18:43:04] "POST /datasets/46e14707-57d6-421e-8e6d-fff953592f2b/hit HTTP/1.1" 200 -
